Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "An Orthonormal basis for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "4"], TraditionalForm]],ExpressionUUID->
  "2d59dcd1-d54b-4515-93b5-f10927cf14d3"]
}], "Title",
 CellChangeTimes->{{3.730868199458239*^9, 3.730868203673456*^9}, {
  3.730877574208508*^9, 
  3.730877602245016*^9}},ExpressionUUID->"82ae3126-1629-4d34-be22-\
1afbfa3f8464"],

Cell["\<\
In this notebook we show how the square popping relation applied by the \
ReduceDiagram function was computed using an earlier version of ReduceDiagram \
(a behaviour simulated here by setting the option ReduceSquares to False).\
\>", "Text",
 CellChangeTimes->{{3.730867852596562*^9, 3.730867921170794*^9}, 
   3.7308683060674887`*^9, {3.730868510104785*^9, 3.7308685461257*^9}, {
   3.731137019429166*^9, 3.731137030677878*^9}, {3.731137910475608*^9, 
   3.731137913366424*^9}},ExpressionUUID->"b681e139-58f5-4532-9f5f-\
2c8495e98509"],

Cell["\<\
First load the Trivalent package and necessary diagrams from the standard \
library.\
\>", "Text",
 CellChangeTimes->{{3.7311371111026897`*^9, 3.731137189919677*^9}, {
  3.73113727544695*^9, 
  3.7311372769842167`*^9}},ExpressionUUID->"abdd36d7-c3f0-4994-8e0b-\
31fb794af8a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "Trivalent`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LoadLibrary", "[", "\"\<stdlib\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7308070185316677`*^9, 3.730807044045423*^9}, {
  3.730807209468358*^9, 3.730807210806678*^9}, {3.730810277711526*^9, 
  3.7308102785669603`*^9}},ExpressionUUID->"ab8a9621-5856-43a2-8380-\
0ba50986a1ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"C4Basis", "=", 
   RowBox[{
    RowBox[{"Retrieve", "[", "\"\<C4Atoms\>\"", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"square", "=", 
   RowBox[{
    RowBox[{"Retrieve", "[", "\"\<C4Atoms\>\"", "]"}], "\[LeftDoubleBracket]",
     "5", "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pso3cond", "=", 
   RowBox[{"Retrieve", "[", "\"\<PSO3Cond\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"realcond", "=", 
   RowBox[{"Retrieve", "[", "\"\<RealCond\>\"", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.730807496106896*^9, 3.7308075293290854`*^9}, 
   3.730808282636345*^9, {3.730808337705305*^9, 3.73080834468064*^9}, {
   3.730810176699873*^9, 3.730810180117725*^9}, {3.7308102547075*^9, 
   3.73081027026373*^9}, {3.730810304692088*^9, 3.730810326503499*^9}, {
   3.730810691412673*^9, 3.7308107150384007`*^9}, {3.730812147610878*^9, 
   3.7308121617510443`*^9}, {3.7308123998830023`*^9, 3.730812403504871*^9}, {
   3.731136690328472*^9, 
   3.731136694611827*^9}},ExpressionUUID->"b33b3a53-989e-4a75-9cf7-\
f53238339b29"],

Cell["\<\
The following are the scalar products of the square with the four faceless \
diagrams.\
\>", "Text",
 CellChangeTimes->{{3.730868041849194*^9, 3.7308680649399967`*^9}, {
   3.730868284626162*^9, 3.7308682850265827`*^9}, 
   3.7311372846364594`*^9},ExpressionUUID->"a8b5accd-cc3c-48b6-af9d-\
c445bb66e728"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"scalarproducts", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ReduceDiagram", "[", 
     RowBox[{
      RowBox[{"DiagramScalar", "[", 
       RowBox[{
        RowBox[{
        "C4Basis", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        ",", "square"}], "]"}], ",", 
      RowBox[{"ReduceSquares", "\[Rule]", "False"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.730810719768551*^9, 3.7308107814453173`*^9}, {
  3.730866314480057*^9, 3.7308663238237343`*^9}, {3.7308663657343073`*^9, 
  3.73086637437643*^9}, {3.7308665265680437`*^9, 3.7308665302443447`*^9}, {
  3.730868067951076*^9, 3.730868071375321*^9}, {3.730868115343833*^9, 
  3.730868116605467*^9}},ExpressionUUID->"d10145ec-df37-4510-9ba2-\
79bd53137040"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["b", "2"], " ", "d"}], ",", 
   RowBox[{
    SuperscriptBox["b", "2"], " ", "d"}], ",", 
   RowBox[{"b", " ", "d", " ", 
    SuperscriptBox["t", "2"]}], ",", 
   RowBox[{"b", " ", "d", " ", 
    SuperscriptBox["t", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.730810783534873*^9, {3.730866325006679*^9, 3.7308663757319603`*^9}, {
   3.730866521011484*^9, 3.730866530759164*^9}, {3.7308681077984123`*^9, 
   3.7308681194767723`*^9}, 3.730873730114305*^9, {3.731136677768957*^9, 
   3.731136700435158*^9}, 3.7317442855083427`*^9, 3.731744334923271*^9, {
   3.731830861376474*^9, 3.731830879633532*^9}, 
   3.7331214104136877`*^9},ExpressionUUID->"1b7e6921-05d0-4514-a368-\
ae8198a352f7"]
}, Open  ]],

Cell["\<\
Compute an orthonormal basis using a version of \
Mathematica\[CloseCurlyQuote]s Gram\[Dash]Schmidt algorithm.\
\>", "Text",
 CellChangeTimes->{{3.731137302197041*^9, 
  3.731137356750906*^9}},ExpressionUUID->"d5a22b5c-b92c-410b-9660-\
d063da3eece4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"C4ONBCoefficients", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DiagramOrthogonalization", "[", "C4Basis", "]"}], ",", 
     "realcond"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.730810328918066*^9, 3.730810357081472*^9}, {
   3.730810404086178*^9, 3.730810438658572*^9}, {3.7308120730628366`*^9, 
   3.730812073978743*^9}, {3.7311367201156797`*^9, 3.7311367377462587`*^9}, 
   3.7317442706261673`*^9},ExpressionUUID->"6f9c241b-e1a3-4b53-a4a1-\
602eaee89994"],

Cell[TextData[{
 "Next come the desired coefficients for the square in trivalent categories \
with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"dim", " ", 
      SubscriptBox["C", "4"]}], "=", "2"}], ",", "3", ",", "4"}], 
   TraditionalForm]],ExpressionUUID->"3f0580a1-c260-4277-bc69-2ad3f6123a79"],
 " (in reverse order)."
}], "Text",
 CellChangeTimes->{{3.730867955911716*^9, 3.7308680312612553`*^9}, {
  3.731136764734992*^9, 
  3.7311367803030033`*^9}},ExpressionUUID->"2a40cf5c-aa05-40e2-bb12-\
9549ee99d28d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"squarecoeff4", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"scalarproducts", ".", 
        RowBox[{
        "C4ONBCoefficients", "\[LeftDoubleBracket]", "j", 
         "\[RightDoubleBracket]"}]}], "*", 
       RowBox[{
       "C4ONBCoefficients", "\[LeftDoubleBracket]", "j", 
        "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "realcond"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.73081102400772*^9, 3.730811049659904*^9}, {
  3.730811943617591*^9, 3.730811996254903*^9}, {3.730812179550601*^9, 
  3.730812180795863*^9}, {3.7308122124354753`*^9, 3.73081225072512*^9}, {
  3.730867673658781*^9, 3.730867677856409*^9}, {3.7308680772441187`*^9, 
  3.7308681051488123`*^9}, {3.7311367557670937`*^9, 3.731136757589505*^9}, {
  3.731744312022243*^9, 
  3.7317443133445063`*^9}},ExpressionUUID->"c7ffa29b-e694-45d9-9dc4-\
bcf8f4292452"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["b", "2"], "+", 
       RowBox[{"b", " ", "t"}], "-", 
       SuperscriptBox["t", "2"]}], ")"}]}], 
    RowBox[{
     RowBox[{"b", " ", "d"}], "+", "t", "+", 
     RowBox[{"d", " ", "t"}]}]], ",", 
   FractionBox[
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["b", "2"], "+", 
       RowBox[{"b", " ", "t"}], "-", 
       SuperscriptBox["t", "2"]}], ")"}]}], 
    RowBox[{
     RowBox[{"b", " ", "d"}], "+", "t", "+", 
     RowBox[{"d", " ", "t"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["b", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "d"}], ")"}], " ", 
      SuperscriptBox["t", "2"]}]}], 
    RowBox[{
     RowBox[{"b", " ", "d"}], "+", "t", "+", 
     RowBox[{"d", " ", "t"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["b", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "d"}], ")"}], " ", 
      SuperscriptBox["t", "2"]}]}], 
    RowBox[{
     RowBox[{"b", " ", "d"}], "+", "t", "+", 
     RowBox[{"d", " ", "t"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.730811963320526*^9, 3.730811996967152*^9}, 
   3.73081218135893*^9, {3.730812223381814*^9, 3.730812252091563*^9}, 
   3.7308665888195744`*^9, {3.730867675049159*^9, 3.730867678432891*^9}, {
   3.730868118700543*^9, 3.730868123111134*^9}, 3.7308737331849127`*^9, {
   3.731136678090197*^9, 3.731136700522749*^9}, 3.731744287121945*^9, 
   3.731744335469728*^9, {3.731830867081463*^9, 3.7318308797079687`*^9}, 
   3.733121411297908*^9},ExpressionUUID->"556b3ca2-5db2-474c-97e5-\
a250a6da9221"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"squarecoeff3", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"scalarproducts", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], ".", 
        RowBox[{"C4ONBCoefficients", "\[LeftDoubleBracket]", 
         RowBox[{"j", ",", 
          RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], "*", 
       RowBox[{"C4ONBCoefficients", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", 
         RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", "realcond"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.730867662516367*^9, 3.730867720360837*^9}, {
  3.730868078660199*^9, 3.730868101899437*^9}, {3.731744319644828*^9, 
  3.731744321741291*^9}, {3.731992755318286*^9, 3.731992764865979*^9}, {
  3.733121484235914*^9, 
  3.733121532174461*^9}},ExpressionUUID->"90dc1485-5756-4ca7-829e-\
46d2625a4e31"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["b", "2"], "-", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox["t", "2"]}]}], 
    RowBox[{"1", "+", "d", "-", 
     SuperscriptBox["d", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "d"}], ")"}]}], "+", 
     SuperscriptBox["t", "2"]}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", "d", "+", 
     SuperscriptBox["d", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["b", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "d"}], ")"}], " ", 
        SuperscriptBox["t", "2"]}]}], ")"}]}], 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "d", "+", 
       SuperscriptBox["d", "2"]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.73086770927531*^9, 3.7308677211385508`*^9}, {
   3.730868119379772*^9, 3.730868124882648*^9}, {3.731136678146017*^9, 
   3.7311367005748*^9}, 3.7317442880371943`*^9, 3.731744335682434*^9, 
   3.731830879960445*^9, {3.7319927531175737`*^9, 3.7319927663198423`*^9}, 
   3.733121411504003*^9, {3.733121488784643*^9, 
   3.733121534463601*^9}},ExpressionUUID->"4976b4a0-af89-4774-91c4-\
47e7ff90e859"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"squarecoeff2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"scalarproducts", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ".", 
        RowBox[{"C4ONBCoefficients", "\[LeftDoubleBracket]", 
         RowBox[{"j", ",", 
          RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], "*", 
       RowBox[{"C4ONBCoefficients", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", 
         RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "realcond"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7308677457333097`*^9, 3.73086775522506*^9}, {
  3.730868079902584*^9, 3.730868099279469*^9}, {3.7317443259001617`*^9, 
  3.7317443283656597`*^9}},ExpressionUUID->"d152140b-3bc7-4eb4-9a56-\
f7e81765801b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    SuperscriptBox["b", "2"], 
    RowBox[{"1", "+", "d"}]], ",", 
   FractionBox[
    SuperscriptBox["b", "2"], 
    RowBox[{"1", "+", "d"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.730867755826499*^9, 3.730868126540003*^9, {3.731136678199823*^9, 
   3.7311367005954723`*^9}, 3.731744288142302*^9, 3.7317443357143497`*^9, 
   3.73183088001438*^9, 
   3.73312141160262*^9},ExpressionUUID->"ff0a3905-c622-44a8-b479-50c17f15707d"]
}, Open  ]],

Cell[TextData[{
 "In the paper, the convention ",
 Cell[BoxData[
  FormBox[
   RowBox[{"b", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "9cbab603-c3b8-44e1-a48f-3fc9114d4d0d"],
 " is used:"
}], "Text",
 CellChangeTimes->{{3.730868133976262*^9, 
  3.730868152099661*^9}},ExpressionUUID->"189b8221-189b-4100-aac0-\
b9a87f9f009c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"scalarproducts", "/.", 
  RowBox[{"b", "\[Rule]", "1"}]}]], "Input",
 CellChangeTimes->{{3.7308680880131807`*^9, 3.730868097368115*^9}, {
  3.7311367980039*^9, 
  3.7311367998224983`*^9}},ExpressionUUID->"ce73392a-7f68-4d39-8c9f-\
f53d6a5f4f88"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"d", ",", "d", ",", 
   RowBox[{"d", " ", 
    SuperscriptBox["t", "2"]}], ",", 
   RowBox[{"d", " ", 
    SuperscriptBox["t", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.730868129612234*^9, {3.7311366782432632`*^9, 3.731136700633645*^9}, 
   3.731136801271126*^9, 3.731744288223681*^9, 3.7317443357429247`*^9, 
   3.731830880065933*^9, 
   3.733121411685948*^9},ExpressionUUID->"2a7d5828-9b0b-44d6-9491-\
d38f7607228e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"squarecoeff4", "/.", 
  RowBox[{"b", "\[Rule]", "1"}]}]], "Input",
 CellChangeTimes->{{3.7308122640429688`*^9, 3.7308123209702063`*^9}, {
  3.730866620427444*^9, 3.7308666587749043`*^9}, {3.730868084514624*^9, 
  3.7308680858791313`*^9}},ExpressionUUID->"03345423-03db-432b-95de-\
cb5967f607f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", "t", "-", 
     SuperscriptBox["t", "2"]}], 
    RowBox[{"d", "+", "t", "+", 
     RowBox[{"d", " ", "t"}]}]], ",", 
   FractionBox[
    RowBox[{"1", "+", "t", "-", 
     SuperscriptBox["t", "2"]}], 
    RowBox[{"d", "+", "t", "+", 
     RowBox[{"d", " ", "t"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "d"}], ")"}], " ", 
      SuperscriptBox["t", "2"]}]}], 
    RowBox[{"d", "+", "t", "+", 
     RowBox[{"d", " ", "t"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "d"}], ")"}], " ", 
      SuperscriptBox["t", "2"]}]}], 
    RowBox[{"d", "+", "t", "+", 
     RowBox[{"d", " ", "t"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7308122695569*^9, 3.730812331000682*^9, 3.7308665999023647`*^9, {
   3.730866643309435*^9, 3.730866659226969*^9}, {3.731136678266178*^9, 
   3.73113670066772*^9}, 3.731744288290609*^9, 3.7317443357750683`*^9, 
   3.731830880146929*^9, 
   3.733121411743433*^9},ExpressionUUID->"9b696004-858a-4636-95b7-\
c11de7fc4f78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"squarecoeff3", "/.", 
  RowBox[{
  "b", "\[Rule]", 
   "1"}]}]], "Input",ExpressionUUID->"8d60601d-38cf-4c6e-a200-a902d4048767"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "-", "d", "+", 
     RowBox[{"d", " ", 
      SuperscriptBox["t", "2"]}]}], 
    RowBox[{"1", "+", "d", "-", 
     SuperscriptBox["d", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "2"}], "+", "d", "+", 
     SuperscriptBox["t", "2"]}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", "d", "+", 
     SuperscriptBox["d", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "d"}], ")"}], " ", 
        SuperscriptBox["t", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", "d", "+", 
     SuperscriptBox["d", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.7317468793615017`*^9, 3.7317469278447447`*^9, 
  3.7318308802137403`*^9, 
  3.733121411795776*^9},ExpressionUUID->"97308509-9d18-432c-a06a-70cb760d7a46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"squarecoeff2", "/.", 
  RowBox[{"b", "\[Rule]", "1"}]}]], "Input",
 CellChangeTimes->{
  3.7308677625518293`*^9},ExpressionUUID->"7542b896-b05d-4a12-98f9-\
b7ff4598cecb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"1", "+", "d"}]], ",", 
   FractionBox["1", 
    RowBox[{"1", "+", "d"}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7308677630404253`*^9, {3.7311366783583183`*^9, 3.731136700784285*^9}, 
   3.7317442884022217`*^9, 3.731744335998927*^9, 3.731830880265462*^9, 
   3.733121411870051*^9},ExpressionUUID->"95412785-d290-42a7-8c63-\
87bfe47b3fb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"squarecoeff3", "/.", 
    RowBox[{"b", "\[Rule]", "1"}]}], ",", 
   RowBox[{"pso3cond", "/.", 
    RowBox[{"b", "\[Rule]", "1"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.73174763854333*^9, 3.731747696504346*^9}, {
  3.733121561555174*^9, 
  3.733121564537189*^9}},ExpressionUUID->"88266fff-facb-4050-839d-\
8718329ff61d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "+", "t", "-", 
     SuperscriptBox["t", "2"]}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", "d", "+", 
     SuperscriptBox["d", "2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "2"}], "+", "d", "+", 
     SuperscriptBox["t", "2"]}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", "d", "+", 
     SuperscriptBox["d", "2"]}]], ",", 
   FractionBox[
    RowBox[{"1", "-", 
     RowBox[{"3", " ", "d"}], "+", 
     SuperscriptBox["d", "2"], "-", 
     RowBox[{"2", " ", "t"}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", "d", "+", 
     SuperscriptBox["d", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.731747642259804*^9, 3.731747697378384*^9}, 
   3.731830880314391*^9, 3.733121411972591*^9, {3.733121542649085*^9, 
   3.733121565145061*^9}},ExpressionUUID->"da5de1d6-85d4-4c79-9be1-\
7d0d9c11d78d"]
}, Open  ]],

Cell["\<\
The standard library stdlib now contains squarecoeff4 etc. as well as C4ONB \
and the full Gramian matrix (irrespective of dimensions) below.\
\>", "Text",
 CellChangeTimes->{{3.7308685556343307`*^9, 3.730868699763812*^9}, {
  3.7311368155422363`*^9, 
  3.731136817169302*^9}},ExpressionUUID->"7f42a64a-7439-44ea-b721-\
4280c544ad26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"C4Atoms", "=", 
   RowBox[{"Retrieve", "[", "\"\<C4Atoms\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7308687804861803`*^9, 
  3.730868791968143*^9}},ExpressionUUID->"60aa12e1-bea8-4a3b-9f53-\
d9ac323d3b0a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"C4Gramian", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"ReduceDiagram", "[", 
       RowBox[{"DiagramScalar", "[", 
        RowBox[{
         RowBox[{
         "C4Atoms", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{
         "C4Atoms", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
        "]"}], "]"}], ",", "realcond"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.73086866410822*^9, 3.73086867067472*^9}, {
   3.7308687096887093`*^9, 3.730868822206416*^9}, {3.730869549818696*^9, 
   3.73086955595925*^9}, {3.730873395425721*^9, 3.7308733958712473`*^9}, 
   3.730876918933032*^9, {3.7308770317595253`*^9, 3.730877034181308*^9}, {
   3.730877121888026*^9, 3.730877140884467*^9}, {3.7308772418837233`*^9, 
   3.730877242311977*^9}},ExpressionUUID->"a073be04-c46a-4109-aa10-\
6bb7317fbd2e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["d", "2"], ",", "d", ",", 
     RowBox[{"b", " ", "d"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     SuperscriptBox["d", "2"], ",", "0", ",", 
     RowBox[{"b", " ", "d"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", " ", "d"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", "t"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"b", " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", "t"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7308688274023848`*^9, 3.730869556567081*^9, 3.730873398683978*^9, 
   3.7308769207583323`*^9, 3.7308770350602694`*^9, 3.730877141997569*^9, 
   3.730877242969606*^9, {3.731136678464411*^9, 3.73113670090016*^9}, 
   3.7317442885094557`*^9, 3.731744336184148*^9, 3.7318308803700237`*^9, 
   3.73312141209324*^9},ExpressionUUID->"78777f68-52bc-4b82-b6e0-2b2aebbe46c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"C4ScalarProducts4", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"ReduceDiagram", "[", 
       RowBox[{
        RowBox[{"DiagramScalar", "[", 
         RowBox[{
          RowBox[{
          "C4Atoms", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "C4Atoms", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
          "]"}], ",", 
        RowBox[{"dimC4", "\[Rule]", "4"}]}], "]"}], ",", "realcond"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.730877356007086*^9, 
  3.7308773764876003`*^9}},ExpressionUUID->"d598c943-d205-48a8-a84a-\
d52784587403"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["d", "2"], ",", "d", ",", 
     RowBox[{"b", " ", "d"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     SuperscriptBox["d", "2"], ",", "0", ",", 
     RowBox[{"b", " ", "d"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", " ", "d"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", "t"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"b", " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", "t"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}], ",", 
     FractionBox[
      RowBox[{"2", " ", "b", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["b", "4"], "+", 
         RowBox[{
          SuperscriptBox["b", "3"], " ", "t"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["t", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "d"}], ")"}], " ", 
          SuperscriptBox["t", "4"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"b", " ", "d"}], "+", "t", "+", 
       RowBox[{"d", " ", "t"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.730877356803936*^9, 3.730877377221839*^9}, {
   3.731136678511145*^9, 3.731136700977456*^9}, 3.731744288594079*^9, 
   3.7317443362740793`*^9, 3.731830880431541*^9, 
   3.733121412195228*^9},ExpressionUUID->"46893bf9-2980-46b0-9a57-\
75711d1d94e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"C4ScalarProducts3", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"ReduceDiagram", "[", 
       RowBox[{
        RowBox[{"DiagramScalar", "[", 
         RowBox[{
          RowBox[{
          "C4Atoms", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "C4Atoms", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
          "]"}], ",", 
        RowBox[{"dimC4", "\[Rule]", "3"}]}], "]"}], ",", "realcond"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.730877362791726*^9, 
  3.730877385966312*^9}},ExpressionUUID->"1669d5e2-bd29-4fb3-b5eb-\
a0702d67c09b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["d", "2"], ",", "d", ",", 
     RowBox[{"b", " ", "d"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     SuperscriptBox["d", "2"], ",", "0", ",", 
     RowBox[{"b", " ", "d"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", " ", "d"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", "t"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"b", " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", "t"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}], ",", 
     FractionBox[
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"2", " ", "d"}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          SuperscriptBox["t", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["d", "2"]}], ")"}], " ", 
          SuperscriptBox["t", "4"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "-", "d", "+", 
       SuperscriptBox["d", "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.730877381653167*^9, 3.730877387203532*^9}, {
   3.731136678588204*^9, 3.731136701075983*^9}, 3.731744288681604*^9, 
   3.7317443363384447`*^9, 3.7318308804971037`*^9, 
   3.733121412338442*^9},ExpressionUUID->"8a4b81d8-5f74-4c3a-8e82-\
9986e29cf0be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"C4ScalarProducts2", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"ReduceDiagram", "[", 
       RowBox[{
        RowBox[{"DiagramScalar", "[", 
         RowBox[{
          RowBox[{
          "C4Atoms", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "C4Atoms", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
          "]"}], ",", 
        RowBox[{"dimC4", "\[Rule]", "2"}], ",", 
        RowBox[{"ReduceSquares", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"i", "\[Equal]", "j", "\[Equal]", "5"}], ")"}]}]}], "]"}], 
      ",", "realcond"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.73087724773281*^9, 
  3.730877364207961*^9}},ExpressionUUID->"ccafcaf5-70ad-46e4-a41d-\
67e06dab4659"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["d", "2"], ",", "d", ",", 
     RowBox[{"b", " ", "d"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     SuperscriptBox["d", "2"], ",", "0", ",", 
     RowBox[{"b", " ", "d"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", " ", "d"}], ",", "0", ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", "t"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"b", " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", "t"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{
      SuperscriptBox["b", "2"], " ", "d"}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}], ",", 
     RowBox[{"b", " ", "d", " ", 
      SuperscriptBox["t", "2"]}], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["b", "4"], " ", "d"}], 
      RowBox[{"1", "+", "d"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.730877321602223*^9, 3.730877365420311*^9}, {
   3.731136678655031*^9, 3.731136701147863*^9}, 3.731744288737749*^9, 
   3.731744336383387*^9, 3.7318308805323257`*^9, 
   3.733121412406761*^9},ExpressionUUID->"7365e2dc-8b98-4cd0-8ade-\
325c17559f30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["C4ONBCoefficients"], "Input",
 CellChangeTimes->{{3.730870397925396*^9, 3.730870446639533*^9}, {
   3.731136853229196*^9, 3.731136858705822*^9}, 
   3.7317442801049347`*^9},ExpressionUUID->"97a9bb9a-3f81-44cc-b233-\
a8d446f921b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Abs", "[", "d", "]"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"d", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["d", "2"]}]]}]]}], ",", 
     FractionBox["1", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"]}]]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"b", " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "d", "+", 
            SuperscriptBox["d", "2"]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["d", "2"]}]]]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "d", "-", 
         SuperscriptBox["d", "2"]}], ")"}], " ", 
       RowBox[{"Abs", "[", "b", "]"}]}]], ",", 
     FractionBox["b", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["d", "2"]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "d", "+", 
            SuperscriptBox["d", "2"]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["d", "2"]}]]], " ", 
       RowBox[{"Abs", "[", "b", "]"}]}]], ",", 
     FractionBox["1", 
      SqrtBox[
       FractionBox[
        RowBox[{
         SuperscriptBox["b", "2"], " ", "d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "d", "+", 
           SuperscriptBox["d", "2"]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["d", "2"]}]]]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"b", "+", 
       RowBox[{"d", " ", "t"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "d", "+", 
         SuperscriptBox["d", "2"]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "d"}], "-", 
            RowBox[{"2", " ", "b", " ", "t"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["d", "2"]}], ")"}], " ", 
             SuperscriptBox["t", "2"]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "1"}], "-", "d", "+", 
          SuperscriptBox["d", "2"]}]]]}]], ",", 
     FractionBox[
      RowBox[{"b", "-", 
       RowBox[{"b", " ", "d"}], "-", "t"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "d", "+", 
         SuperscriptBox["d", "2"]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "d"}], "-", 
            RowBox[{"2", " ", "b", " ", "t"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["d", "2"]}], ")"}], " ", 
             SuperscriptBox["t", "2"]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "1"}], "-", "d", "+", 
          SuperscriptBox["d", "2"]}]]]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "b"}], "+", "t", "-", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", "t"}]}], 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "d", "+", 
         SuperscriptBox["d", "2"]}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "d"}], "-", 
            RowBox[{"2", " ", "b", " ", "t"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["d", "2"]}], ")"}], " ", 
             SuperscriptBox["t", "2"]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "1"}], "-", "d", "+", 
          SuperscriptBox["d", "2"]}]]]}]], ",", 
     FractionBox["1", 
      SqrtBox[
       FractionBox[
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "d"}], "-", 
           RowBox[{"2", " ", "b", " ", "t"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["d", "2"]}], ")"}], " ", 
            SuperscriptBox["t", "2"]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "-", "d", "+", 
         SuperscriptBox["d", "2"]}]]]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.730870400638801*^9, 3.7308704472445087`*^9}, {
   3.7311366787651367`*^9, 3.731136701199337*^9}, {3.7311368406446323`*^9, 
   3.73113685970772*^9}, 3.7317442888080597`*^9, 3.7317443364319763`*^9, {
   3.73183087333146*^9, 3.731830880598309*^9}, 
   3.733121412468691*^9},ExpressionUUID->"06c54071-9090-4ecb-9d65-\
8ced53146cb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"window4", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"ReduceDiagram", "[", 
     RowBox[{
      RowBox[{"DiagramScalar", "[", 
       RowBox[{"square", ",", "square"}], "]"}], ",", 
      RowBox[{"dimC4", "\[Rule]", "4"}]}], "]"}], ",", "realcond"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.73253016159303*^9, 3.732530189194079*^9}, {
  3.73253022919589*^9, 
  3.732530268492197*^9}},ExpressionUUID->"104c66ec-43a6-4e33-8cb7-\
3e377d72229a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "b", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["b", "4"], "+", 
     RowBox[{
      SuperscriptBox["b", "3"], " ", "t"}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"], " ", 
      SuperscriptBox["t", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "d"}], ")"}], " ", 
      SuperscriptBox["t", "4"]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"b", " ", "d"}], "+", "t", "+", 
   RowBox[{"d", " ", "t"}]}]]], "Output",
 CellChangeTimes->{{3.732530252616664*^9, 3.7325302700789967`*^9}, 
   3.733121412527376*^9},ExpressionUUID->"c8c03bab-8c33-4799-b28e-\
77370736086e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"window3", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"ReduceDiagram", "[", 
     RowBox[{
      RowBox[{"DiagramScalar", "[", 
       RowBox[{"square", ",", "square"}], "]"}], ",", 
      RowBox[{"dimC4", "\[Rule]", "3"}]}], "]"}], ",", "realcond"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.73253016159303*^9, 3.732530189194079*^9}, {
  3.73253022919589*^9, 3.732530327697392*^9}, {3.732530377575552*^9, 
  3.732530378270503*^9}},ExpressionUUID->"4ff2c3e2-3cfb-42a2-a5aa-\
27c68f913db6"],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["b", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        RowBox[{"2", " ", "d"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      SuperscriptBox["t", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"]}], ")"}], " ", 
      SuperscriptBox["t", "4"]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "-", "d", "+", 
   SuperscriptBox["d", "2"]}]]], "Output",
 CellChangeTimes->{{3.73253028522297*^9, 3.732530328525941*^9}, 
   3.732530379814045*^9, 
   3.733121412611207*^9},ExpressionUUID->"8f29fdef-e03e-43f3-8465-\
f5615063d969"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"window2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"ReduceDiagram", "[", 
     RowBox[{
      RowBox[{"DiagramScalar", "[", 
       RowBox[{"square", ",", "square"}], "]"}], ",", 
      RowBox[{"dimC4", "\[Rule]", "2"}]}], "]"}], ",", "realcond"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.73253016159303*^9, 3.732530189194079*^9}, {
  3.73253022919589*^9, 
  3.73253029535773*^9}},ExpressionUUID->"c8e8062a-6e4b-4bfc-b0ab-\
6885f7b3e569"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["b", "4"], " ", "d"}], 
  RowBox[{"1", "+", "d"}]]], "Output",
 CellChangeTimes->{3.732530295904591*^9, 
  3.733121412679056*^9},ExpressionUUID->"3918a51d-3f17-42f1-b167-e2fe82bda6e4"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{822, 833},
WindowMargins->{{-1234, Automatic}, {Automatic, 60}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
